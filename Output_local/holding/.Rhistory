setwd("C:/Users/HP/Box/New Computer/Auburn/Data/KRats") #set working directory in the Rstudio folder on my computer and box drive
directory = getwd()
field = read.table("KRATP.csv", header=T, sep=",")
data  = read.table("krat_pedigree_plus.csv", header=T, sep=",")
setwd("C:/Users/HP/Box/New Computer/Auburn/Data/KRats") #set working directory in the Rstudio folder on my computer and box drive
getwd()
setwd("C:/Users/HP/Box/New Computer/Auburn/Data/KRats") #set working directory in the Rstudio folder on my computer and box drive
tab = read.table("ABM_run.1.18.23_c_all_summary.csv", header=T, sep=",")
smry = tab
setwd("C:/Users/ginab/Box/New Computer/Auburn/Data/ComplexModel_ABM/Output_local/holding") #setwd("C:/Users/Gina/Desktop/2022/ComplexModel_ABM")
directory = getwd()
outdir = paste(directory, "/figs/", sep = "")
tab = read.table("ABM_run.1.18.23_c_all_summary.csv", header=T, sep=",")
smry = tab
#~~~Avril's Code
### set colors
library(ghibli)
library(scales)
gt.cols <- ghibli_palette('PonyoMedium')#[4]
lt.gt.col <- ghibli_palette('PonyoLight')[4]
yr       = smry[,1]   #year
n        = smry[,2]   #population size
propmig  = smry[,3]   #proportion of pop that are migrants
He       = smry[,4]   #He
Ho       = smry[,5]   #Ho
fis      = smry[,6]   #fis vs initialized pop
nadult   = smry[,7]   #number of indv that have reached maturity
sx       = smry[,8]   #sex ratio
nmig     = smry[,9]   #number of migrants
fst      = smry[,10]  #fst vs initialized pop
rep      = smry[,11]  #replicate number
noff     = smry[,13]  #number of offspring produced that year
fstvs    = smry[,14]  #fst vs the source pop
fisvs    = smry[,15]  #fis vs the source po
table(smry[,12])
col      = smry[,12]-1
plot(-100, -100 , xlab="year", ylab="population size", xlim=c(0, max(yr)), ylim=c(0, max(n)))
points(yr, n, col="firebrick")
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
tab = read.table("ABM_run.1.11.23_E_all_summary.csv", header=T, sep=",")
setwd("C:/Users/ginab/Box/New Computer/Auburn/Data/ComplexModel_ABM/Output_local/holding") #setwd("C:/Users/Gina/Desktop/2022/ComplexModel_ABM")
directory = getwd()
outdir = paste(directory, "/figs/", sep = "")
tab = read.table("ABM_run.1.11.23_E_all_summary.csv", header=T, sep=",")
table(tab[,12])
grp1 <- tab[tab[,12]<=8,,drop=FALSE]
grp2 <- tab[tab[,12]>8&<17,,drop=FALSE]
grp2 <- tab[tab[,12]>=17,,drop=FALSE]
grp2 <- tab[tab[,12]%NOTin%grp1|grp2,,drop=FALSE]
'%NOTin%' <- Negate(`%in%`) #this defines the not in function so that I can select identities that are not defined by something (see RandomDeaths.R for an example)
grp2 <- tab[tab[,12]%NOTin%grp1|grp2,,drop=FALSE]
grp1 <- tab[tab[,12]<=8,,drop=FALSE]
grp3 <- tab[tab[,12]>=17,,drop=FALSE]
grp2 <- tab[tab[,12]%NOTin%grp1|grp2,,drop=FALSE]
grp2 <- tab[tab[,12]%NOTin%grp1&tab[,12]%NOTin%grp2,,drop=FALSE]
grp3 <- tab[tab[,12]>=17,,drop=FALSE]
smry = tab3
smry = grp3
yr       = smry[,1]   #year
n        = smry[,2]   #population size
propmig  = smry[,3]   #proportion of pop that are migrants
He       = smry[,4]   #He
Ho       = smry[,5]   #Ho
fis      = smry[,6]   #fis vs initialized pop
nadult   = smry[,7]   #number of indv that have reached maturity
sx       = smry[,8]   #sex ratio
nmig     = smry[,9]   #number of migrants
fst      = smry[,10]  #fst vs initialized pop
rep      = smry[,11]  #replicate number
noff     = smry[,13]  #number of offspring produced that year
fstvs    = smry[,14]  #fst vs the source pop
fisvs    = smry[,15]  #fis vs the source pop
col      = smry[,12]-1
plot(-100, -100 , xlab="year", ylab="population size", xlim=c(0, max(yr)), ylim=c(0, max(n)))
points(yr, n, col="firebrick")
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
library(ghibli)
library(scales)
gt.cols <- ghibli_palette('PonyoMedium')#[4]
lt.gt.col <- ghibli_palette('PonyoLight')[4]
plot(-100, -100 , xlab="year", ylab="population size", xlim=c(0, max(yr)), ylim=c(0, max(n)))
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
dev.off()
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
gt.cols[col]
col      = smry[,12]
points(yr,Ho,col=gt.cols[col])
gt.cols[col]
setwd("C:/Users/ginab/Box/New Computer/Auburn/Data/ComplexModel_ABM/Output_local/holding") #setwd("C:/Users/Gina/Desktop/2022/ComplexModel_ABM")
directory = getwd()
outdir = paste(directory, "/figs/", sep = "")
tab = read.table("ABM_run.1.11.23_E_all_summary.csv", header=T, sep=",")
grp1 <- tab[tab[,12]<=8,,drop=FALSE]
grp3 <- tab[tab[,12]>=17,,drop=FALSE]
grp2 <- tab[tab[,12]%NOTin%grp1&tab[,12]%NOTin%grp2,,drop=FALSE]
'%NOTin%' <- Negate(`%in%`) #this defines the not in function so that I can select identities that are not defined by something (see RandomDeaths.R for an example)
grp2 <- tab[tab[,12]%NOTin%grp1&tab[,12]%NOTin%grp2,,drop=FALSE]
grp2 <- tab[tab[,12]%NOTin%grp1&tab[,12]%NOTin%grp3,,drop=FALSE]
grp2 <- tab[tab[,12]>8&tab[,12]<17,,drop=FALSE]
107059-53352-2054
smry = grp3
table(grp3[,12])
#add Density Independent variance in growth
Nt1 = round(rnorm(1, Ntt, 1), 0)
library(pals)
gt.cols <- pals_palette('ploychrome') #ghibli_palette('PonyoMedium')#[4]
gt.cols <- pals_palette('polychrome') #ghibli_palette('PonyoMedium')#[4]
library(colorspace)
gt.cols <- qualitative_hcl(8, "Dark2") #ghibli_palette('PonyoMedium')#[4]
lt.gt.col <- qualitative_hcl(8, "Light2") #ghibli_palette('PonyoLight')[4]
lt.gt.col <- qualitative_hcl(8, "Pastel1") #ghibli_palette('PonyoLight')[4]
demoplot(gt.cols, "bar")
demoplot(lt.gt.col, "bar")
yr       = smry[,1]   #year
n        = smry[,2]   #population size
propmig  = smry[,3]   #proportion of pop that are migrants
He       = smry[,4]   #He
Ho       = smry[,5]   #Ho
fis      = smry[,6]   #fis vs initialized pop
nadult   = smry[,7]   #number of indv that have reached maturity
sx       = smry[,8]   #sex ratio
nmig     = smry[,9]   #number of migrants
fst      = smry[,10]  #fst vs initialized pop
rep      = smry[,11]  #replicate number
noff     = smry[,13]  #number of offspring produced that year
fstvs    = smry[,14]  #fst vs the source pop
fisvs    = smry[,15]  #fis vs the source pop
col      = smry[,12]
plot(-100, -100 , xlab="year", ylab="population size", xlim=c(0, max(yr)), ylim=c(0, max(n)))
points(yr, n, col="firebrick")
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
gt.cols[col]
col
gt.cols <- qualitative_hcl(24, "Dark2") #ghibli_palette('PonyoMedium')#[4]
lt.gt.col <- qualitative_hcl(24, "Pastel1") #ghibli_palette('PonyoLight')[4]
demoplot(gt.cols, "bar")
demoplot(lt.gt.col, "bar")
yr       = smry[,1]   #year
n        = smry[,2]   #population size
propmig  = smry[,3]   #proportion of pop that are migrants
He       = smry[,4]   #He
Ho       = smry[,5]   #Ho
fis      = smry[,6]   #fis vs initialized pop
nadult   = smry[,7]   #number of indv that have reached maturity
sx       = smry[,8]   #sex ratio
nmig     = smry[,9]   #number of migrants
fst      = smry[,10]  #fst vs initialized pop
rep      = smry[,11]  #replicate number
noff     = smry[,13]  #number of offspring produced that year
fstvs    = smry[,14]  #fst vs the source pop
fisvs    = smry[,15]  #fis vs the source pop
col      = smry[,12]
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
plot(-100, -100 , xlab="year", ylab="Fis", xlim=c(0, max(yr)), ylim=c((min(fis)-.01), (max(fis)+.1)))
points(yr,fis,col=gt.cols[col])
plot(-100, -100 , xlab="year", ylab="Fst", xlim=c(0, max(yr)), ylim=c((min(fst)-.01), (max(fst)+.05)))
points(yr,fst,col=gt.cols[col])
plot(-100, -100 , xlab="year", ylab="prop migrant SNPs", xlim=c(0, max(yr)), ylim=c(0, 1))
points(yr,smry[,17],col=gt.cols[col])
smry = grp2
yr       = smry[,1]   #year
n        = smry[,2]   #population size
propmig  = smry[,3]   #proportion of pop that are migrants
He       = smry[,4]   #He
Ho       = smry[,5]   #Ho
fis      = smry[,6]   #fis vs initialized pop
nadult   = smry[,7]   #number of indv that have reached maturity
sx       = smry[,8]   #sex ratio
nmig     = smry[,9]   #number of migrants
fst      = smry[,10]  #fst vs initialized pop
rep      = smry[,11]  #replicate number
noff     = smry[,13]  #number of offspring produced that year
fstvs    = smry[,14]  #fst vs the source pop
fisvs    = smry[,15]  #fis vs the source pop
col      = smry[,12]
plot(-100, -100 , xlab="year", ylab="population size", xlim=c(0, max(yr)), ylim=c(0, max(n)))
points(yr, n, col="firebrick")
plot(-100, -100 , xlab="year", ylab="Ho", xlim=c(0, max(yr)), ylim=c((min(Ho)), (max(Ho)+.1)))
points(yr,Ho,col=gt.cols[col])
plot(-100, -100 , xlab="year", ylab="Fis", xlim=c(0, max(yr)), ylim=c((min(fis)-.01), (max(fis)+.1)))
points(yr,fis,col=gt.cols[col])
plot(-100, -100 , xlab="year", ylab="sex ratio", xlim=c(0, max(yr)), ylim=c((min(sx)-.1), (max(sx)+.1)))
points(yr,sx,col=gt.cols[col])
plot(-100, -100 , xlab="year", ylab="prop migrant SNPs", xlim=c(0, max(yr)), ylim=c(0, 1))
points(yr,smry[,17],col=gt.cols[col])
plot(-100, -100 , xlab="Ho drift SNPs", ylab="Ho all SNPS", xlim=c(0, 1), ylim=c(0, 1))
points(Ho,smry[,18],col=gt.cols[col])
